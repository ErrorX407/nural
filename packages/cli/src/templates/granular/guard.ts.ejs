import { defineGuard } from "@nuraljs/core";

export const <%= camelName %>Guard = defineGuard(async (req, context) => {
  // 1. Read Metadata from the Route
  // e.g., createRoute({ meta: { role: 'admin' } })
  const requiredRole = context.meta.role;

  if (!requiredRole) {
  return true; // No role required, allow access
  }

  // 2. Check User (assuming middleware attached user)
  const user = (req as Record<string, unknown>).user as { role?: string } | undefined;

    if (!user || user.role !== requiredRole) {
    return false; // ðŸš« Block access (403)
    }

    return true; // âœ… Allow access
    });